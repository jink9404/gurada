<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gurada.ProductMapper">
<!-- 	mybatis 자료형 int / hashmap / string 전부 소문자 -->
	
<!-- 	관리자가 상품을 등록 할때 사용
 -->
	<insert id ="insert" parameterType="product">
      insert 
      into product(name,price,QUANTITY,CATEGORY_ID,GENDER,P_SIZE ,DETAIL,receipt_Date,PRODUCT_ID,pfname,pfsize) 
      values(#{name},#{price},#{quantity},#{categoryId},#{gender},#{pSize},#{detail}, sysdate, SEQ_PRODUCTID_NO.nextval, #{pfname}, #{pfsize})
   </insert>
	

	<select id="select" parameterType="product" resultType="product">
		select name, price, p_size 
		from product
		where gender = #{gender} and category_id= #{categoryId} and name=#{name}
	</select>
	
<!-- 	작성자: 김명진
		리스트 얻어오는 mapper categoryid와 gender (조건)AND 하여 가지고옴
-->
	<select id="selectList" parameterType="product" resultType="product">
		SELECT * 
			FROM product
			<if test="categoryId!=null and gender != null"> 
				WHERE	category_id=#{categoryId} AND gender=#{gender}	
			</if>
	</select>
<!-- 	작성자 : 김명진 
		return -> product 테이블 총 튜플 수
-->
	<select id="countProduct" parameterType="product" resultType="int">
		SELECT COUNT(*)
			FROM product
			<if test="categoryId!=null and gender != null">
				WHERE	category_id=#{categoryId} AND gender=#{gender}
			</if>
	</select>	

	<select id="selectListPaging" parameterType="hashmap" resultType="product">
		SELECT * 
			FROM ( SELECT ROWNUM RN, A.* 
						FROM (SELECT * 
								FROM product 
								WHERE gender=#{productVo.gender} AND category_id=#{productVo.categoryId} 
								ORDER BY TO_NUMBER(product_id) desc
							  ) A
				  )
		 	WHERE RN BETWEEN #{pageVo.start} AND #{pageVo.end}
	</select>
</mapper> 